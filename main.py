import base64
exec(base64.b64decode('aW1wb3J0IHJlcXVlc3RzCmltcG9ydCB0aW1lCmltcG9ydCBvcwppbXBvcnQgcmUKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgaHR0cC5zZXJ2ZXIKaW1wb3J0IHNvY2tldHNlcnZlcgpmcm9tIHJlcXVlc3RzLmV4Y2VwdGlvbnMgaW1wb3J0IFJlcXVlc3RFeGNlcHRpb24sIENvbm5lY3Rpb25FcnJvcgoKIyBDdXN0b20gSFRUUCByZXF1ZXN0IGhhbmRsZXIKY2xhc3MgTXlIYW5kbGVyKGh0dHAuc2VydmVyLlNpbXBsZUhUVFBSZXF1ZXN0SGFuZGxlcik6CiAgICBkZWYgZG9fR0VUKHNlbGYpOgogICAgICAgIHNlbGYuc2VuZF9yZXNwb25zZSgyMDApCiAgICAgICAgc2VsZi5zZW5kX2hlYWRlcignQ29udGVudC10eXBlJywgJ3RleHQvcGxhaW4nKQogICAgICAgIHNlbGYuZW5kX2hlYWRlcnMoKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoYiIgUzNSVjNSIElTIFJVTk4xTkciKQoKZGVmIGV4ZWN1dGVfc2VydmVyKCk6CiAgICAiIiJTdGFydCBhIHNpbXBsZSBIVFRQIHNlcnZlci4iIiIKICAgIFBPUlQgPSBpbnQob3MuZ2V0ZW52KCdQT1JUJywgODA4MCkpCiAgICB3aXRoIHNvY2tldHNlcnZlci5UQ1BTZXJ2ZXIoKCIiLCBQT1JUKSwgTXlIYW5kbGVyKSBhcyBodHRwZDoKICAgICAgICBwcmludChmIlNlcnZlciBydW5uaW5nIGF0IGh0dHA6Ly9sb2NhbGhvc3Q6e1BPUlR9IikKICAgICAgICBodHRwZC5zZXJ2ZV9mb3JldmVyKCkKCmRlZiBjbGVhcl9zY3JlZW4oKToKICAgICIiIkNsZWFyIHRoZSB0ZXJtaW5hbCBzY3JlZW4uIiIiCiAgICBvcy5zeXN0ZW0oJ2NscycgaWYgb3MubmFtZSA9PSAnbnQnIGVsc2UgJ2NsZWFyJykKCmRlZiBwcmludF9saW5lcygpOgogICAgIiIiUHJpbnQgY3VzdG9tIGxpbmVzIGZvciBkaXNwbGF5LiIiIgogICAgcHJpbnQoJ1x1MDAxYlszN20nICsgJ1vinJNdIFJJU0hBQiBTQlIgUlVMRVg8MycpCgpkZWYgcHJpbnRfbGluZXMyKCk6CiAgICAiIiJQcmludCBhbm90aGVyIGN1c3RvbSBsaW5lLiIiIgogICAgcHJpbnQoJ1x1MDAxYlszN20nICsgJzw9PVJJU0hBQiBLQUZJSVIgU0JSPT0+JykKCiMgRGVmaW5lIGNvbG9yIGNvbnN0YW50cyBmb3IgdGVybWluYWwgb3V0cHV0CkdSRUVOID0gIlwwMzNbMTszMjsxbSIKUkVEID0gIlwwMzNbMTszMTsxbSIKQ1lBTiA9ICJcMDMzWzE7MzY7MW0iClJFU0VUID0gIlwwMzNbMG0iCgpkZWYgcmVhZF9maWxlKGZpbGVfcGF0aCk6CiAgICAiIiJSZWFkIGxpbmVzIGZyb20gYSBmaWxlIGFuZCByZXR1cm4gYXMgYSBsaXN0LiIiIgogICAgdHJ5OgogICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICdyJykgYXMgZmlsZToKICAgICAgICAgICAgcmV0dXJuIFtsaW5lLnN0cmlwKCkgZm9yIGxpbmUgaW4gZmlsZS5yZWFkbGluZXMoKV0KICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoKICAgICAgICBwcmludChmIntSRUR9WyFdIEZpbGUgbm90IGZvdW5kOiB7ZmlsZV9wYXRofS4gRXhpdGluZy4uLiIpCiAgICAgICAgcmV0dXJuIE5vbmUKCmRlZiByZWFkX3Bvc3RfdWlkKCk6CiAgICAiIiJSZWFkIHBvc3QgVUlEIGZyb20gJ3Bvc3RfdWlkLnR4dCcgZmlsZS4iIiIKICAgIHBvc3RfdWlkcyA9IHJlYWRfZmlsZSgncG9zdF91aWQudHh0JykKICAgIHJldHVybiBwb3N0X3VpZHNbMF0gaWYgcG9zdF91aWRzIGVsc2UgTm9uZQoKZGVmIHJlYWRfZGVsYXkoKToKICAgICIiIlJlYWQgZGVsYXkgdGltZSBmcm9tICd0aW1lLnR4dCcgZmlsZS4iIiIKICAgIHRyeToKICAgICAgICBkZWxheSA9IGludChyZWFkX2ZpbGUoJ3RpbWUudHh0JylbMF0pCiAgICAgICAgcmV0dXJuIG1heChkZWxheSwgNjApICAjIFNldCBtaW5pbXVtIGRlbGF5IHRvIDYwIHNlY29uZHMKICAgIGV4Y2VwdCAoVmFsdWVFcnJvciwgSW5kZXhFcnJvcik6CiAgICAgICAgcHJpbnQoZiJ7UkVEfVshXSBJbnZhbGlkIG9yIG1pc3NpbmcgJ3RpbWUudHh0Jy4gU2V0dGluZyBkZWxheSB0byBkZWZhdWx0IG9mIDYwIHNlY29uZHMuIikKICAgICAgICByZXR1cm4gNjAKCmRlZiBjaGVja19pbnRlcm5ldCgpOgogICAgIiIiQ2hlY2sgaWYgaW50ZXJuZXQgaXMgYXZhaWxhYmxlIGJ5IHBpbmdpbmcgYSByZWxpYWJsZSB3ZWJzaXRlLiIiIgogICAgdHJ5OgogICAgICAgIHJlcXVlc3RzLmdldCgnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbScsIHRpbWVvdXQ9NSkKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZXhjZXB0IChSZXF1ZXN0RXhjZXB0aW9uLCBDb25uZWN0aW9uRXJyb3IpOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIG1ha2VfcmVxdWVzdCh1cmwsIGhlYWRlcnMsIGNvb2tpZSk6CiAgICAiIiJNYWtlIGEgR0VUIHJlcXVlc3QgdG8gdGhlIHNwZWNpZmllZCBVUkwuIiIiCiAgICB3aGlsZSBub3QgY2hlY2tfaW50ZXJuZXQoKToKICAgICAgICBwcmludChmIntSRUR9WyFdIE5vIGludGVybmV0IGNvbm5lY3Rpb24uIFJldHJ5aW5nLi4uIikKICAgICAgICB0aW1lLnNsZWVwKDUpCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGNvb2tpZXM9eydDb29raWUnOiBjb29raWV9KS50ZXh0CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlCiAgICBleGNlcHQgUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYie1JFRH1bIV0gRXJyb3IgbWFraW5nIHJlcXVlc3Q6IiwgZSkKICAgICAgICByZXR1cm4gTm9uZQoKZGVmIG1haW4oKToKICAgIGNsZWFyX3NjcmVlbigpCiAgICBwcmludChmIntHUkVFTn3jgJBUb29sIFN0YXJ0IFRpbWXjgJE6IiwgdGltZS5zdHJmdGltZSgiJVktJW0tJWQgJUg6JU06JVMiKSkKCiAgICBoZWFkZXJzID0gewogICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMTsgUk1YMjE0NCBCdWlsZC9SS1ExLjIwMTIxNy4wMDI7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvMTAzLjAuNTA2MC43MSBNb2JpbGUgU2FmYXJpLzUzNy4zNiBbRkJfSUFCL0ZCNEE7RkJBVi8zNzUuMS4wLjI4LjExMTtdJwogICAgfQoKICAgIGNvb2tpZXNfZGF0YSA9IHJlYWRfZmlsZSgnY29va2llLnR4dCcpCiAgICB2YWxpZF9jb29raWVzID0gW10KCiAgICBpZiBub3QgY29va2llc19kYXRhOgogICAgICAgIHByaW50KGYie1JFRH1bIV0gTm8gY29va2llcyBmb3VuZC4gRXhpdGluZy4uLiIpCiAgICAgICAgcmV0dXJuCgogICAgZm9yIGNvb2tpZSBpbiBjb29raWVzX2RhdGE6CiAgICAgICAgcmVzcG9uc2UgPSBtYWtlX3JlcXVlc3QoJ2h0dHBzOi8vYnVzaW5lc3MuZmFjZWJvb2suY29tL2J1c2luZXNzX2xvY2F0aW9ucycsIGhlYWRlcnM9aGVhZGVycywgY29va2llPWNvb2tpZSkKICAgICAgICBpZiByZXNwb25zZToKICAgICAgICAgICAgdG9rZW5fbWF0Y2ggPSByZS5zZWFyY2goJyhFQUFHXHcrKScsIHN0cihyZXNwb25zZSkpCiAgICAgICAgICAgIGlmIHRva2VuX21hdGNoOgogICAgICAgICAgICAgICAgdmFsaWRfY29va2llcy5hcHBlbmQoKGNvb2tpZSwgdG9rZW5fbWF0Y2guZ3JvdXAoMSkpKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7UkVEfVshXSBFQUFHIHRva2VuIG5vdCBmb3VuZCBmb3IgY29va2llOiIsIGNvb2tpZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludChmIntSRUR9WyFdIE5vIHJlc3BvbnNlIGZvciBjb29raWU6IiwgY29va2llKQoKICAgIGlmIG5vdCB2YWxpZF9jb29raWVzOgogICAgICAgIHByaW50KGYie1JFRH1bIV0gTm8gdmFsaWQgY29va2llIGZvdW5kLiBFeGl0aW5nLi4uIikKICAgICAgICByZXR1cm4KCiAgICB0YXJnZXRfaWQgPSByZWFkX3Bvc3RfdWlkKCkKICAgIGlmIG5vdCB0YXJnZXRfaWQ6CiAgICAgICAgcHJpbnQoZiJ7UkVEfVshXSBObyBwb3N0IFVJRCBmb3VuZC4gRXhpdGluZy4uLiIpCiAgICAgICAgcmV0dXJuCgogICAgZmlyc3RfbmFtZXMgPSByZWFkX2ZpbGUoJ2ZpcnN0X25hbWVzLnR4dCcpCiAgICBsYXN0X25hbWVzID0gcmVhZF9maWxlKCdsYXN0X25hbWVzLnR4dCcpCiAgICBpZiBub3QgZmlyc3RfbmFtZXMgb3Igbm90IGxhc3RfbmFtZXM6CiAgICAgICAgcHJpbnQoZiJ7UkVEfVshXSBGaXJzdCBuYW1lcyBvciBsYXN0IG5hbWVzIGZpbGUgaXMgbWlzc2luZy4gRXhpdGluZy4uLiIpCiAgICAgICAgcmV0dXJuCgogICAgcHJpbnRfbGluZXMoKQogICAgZGVsYXkgPSByZWFkX2RlbGF5KCkKICAgIGNvbW1lbnRzID0gcmVhZF9maWxlKCdjb21tZW50cy50eHQnKQogICAgaWYgbm90IGNvbW1lbnRzOgogICAgICAgIHByaW50KGYie1JFRH1bIV0gQ29tbWVudHMgZmlsZSBpcyBlbXB0eSBvciBtaXNzaW5nLiBFeGl0aW5nLi4uIikKICAgICAgICByZXR1cm4KCiAgICBjb21tZW50X2luZGV4ID0gMAogICAgY29va2llX2luZGV4ID0gMAoKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjb21tZW50X3RleHQgPSBjb21tZW50c1tjb21tZW50X2luZGV4XS5zdHJpcCgpCgogICAgICAgICAgICBmb3IgZmlyc3RfbmFtZSBpbiBmaXJzdF9uYW1lczoKICAgICAgICAgICAgICAgIGZvciBsYXN0X25hbWUgaW4gbGFzdF9uYW1lczoKICAgICAgICAgICAgICAgICAgICBjb21tZW50X3dpdGhfbmFtZSA9IGYie2ZpcnN0X25hbWV9IHtjb21tZW50X3RleHR9IHtsYXN0X25hbWV9IgoKICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2Nvb2tpZSwgdG9rZW5fZWFhZyA9IHZhbGlkX2Nvb2tpZXNbY29va2llX2luZGV4XQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSB7J21lc3NhZ2UnOiBjb21tZW50X3dpdGhfbmFtZSwgJ2FjY2Vzc190b2tlbic6IHRva2VuX2VhYWd9CgogICAgICAgICAgICAgICAgICAgIHByaW50KGYie0NZQU59W+Kck10gUE9TVCBMTzREM1IgQ09NTUVOVCBTRU5ESU5HIikKICAgICAgICAgICAgICAgICAgICByZXNwb25zZTIgPSByZXF1ZXN0cy5wb3N0KGYnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20ve3RhcmdldF9pZH0vY29tbWVudHMvJywgZGF0YT1kYXRhLCBjb29raWVzPXsnQ29va2llJzogY3VycmVudF9jb29raWV9KS5qc29uKCkKCiAgICAgICAgICAgICAgICAgICAgaWYgJ2lkJyBpbiByZXNwb25zZTI6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie0dSRUVOfVBvc3QgSUQgOjoiLCB0YXJnZXRfaWQpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie0dSRUVOfURhdGUgdGltZSA6OiIsIHRpbWUuc3RyZnRpbWUoIiVZLSVtLSVkICVIOiVNOiVTIikpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie0dSRUVOfUNPT0tJRSBOby4gOjoiLCBjb29raWVfaW5kZXggKyAxKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIntDWUFOfUNvbW1lbnQgc2VudCBzdWNjZXNzZnVsbHk6IiwgY29tbWVudF93aXRoX25hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50X2xpbmVzMigpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJ7UkVEfVshXSBGYWlsZWQgdG8gc2VuZCBjb21tZW50IHdpdGggY29va2llIG51bWJlciB7Y29va2llX2luZGV4ICsgMX0iKQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnZXJyb3InIGluIHJlc3BvbnNlMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie1JFRH1FcnJvciBDb2RlOiIsIHJlc3BvbnNlMlsnZXJyb3InXS5nZXQoJ2NvZGUnKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie1JFRH1NZXNzYWdlOiIsIHJlc3BvbnNlMlsnZXJyb3InXS5nZXQoJ21lc3NhZ2UnKSkKCiAgICAgICAgICAgICAgICAgICAgY29va2llX2luZGV4ID0gKGNvb2tpZV9pbmRleCArIDEpICUgbGVuKHZhbGlkX2Nvb2tpZXMpCgogICAgICAgICAgICBjb21tZW50X2luZGV4ID0gKGNvbW1lbnRfaW5kZXggKyAxKSAlIGxlbihjb21tZW50cykKICAgICAgICAgICAgdGltZS5zbGVlcChkZWxheSkKCiAgICAgICAgZXhjZXB0IFJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJ7UkVEfVshXSBFcnJvciBtYWtpbmcgcmVxdWVzdDoiLCBlKQogICAgICAgICAgICB0aW1lLnNsZWVwKDUuNSkKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludChmIntSRUR9WyFdIEFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQ6IiwgZSkKICAgICAgICAgICAgYnJlYWsKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBzZXJ2ZXJfdGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9ZXhlY3V0ZV9zZXJ2ZXIpCiAgICBzZXJ2ZXJfdGhyZWFkLmRhZW1vbiA9IFRydWUKICAgIHNlcnZlcl90aHJlYWQuc3RhcnQoKQoKICAgIG1haW4oKQ=='))
